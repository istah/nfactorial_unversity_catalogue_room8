## QA Report – 2025-12-18

**Scope**: Backend FastAPI service for University Catalogue (endpoints `/api/health`, `/api/meta`, `/api/universities`, `/api/universities/{id}`).

### 1. Environment & Runtime Status

- **Observation**: Attempts to reach `http://localhost:8000/api/health`, `/api/meta`, `/api/universities` via MCP Playwright returned `ERR_CONNECTION_REFUSED`.
- **Impact**: Unable to validate live runtime behavior from this environment at the time of the report.
- **Severity**: Medium (blocks runtime-level verification, but not a product bug).
- **Notes**: Most likely backend server is not running or is bound to a different host/port. This is an environment/setup issue, **not classified as a bug**.

### 2. Backend Structure Review

- **FastAPI Application**
  - `backend/app/main.py` defines `create_app()` using an application factory and exports `app = create_app()`.
  - Routers are registered via `backend/app/routers.py` (see AGENTS.md description).
  - **Assessment**: Application factory pattern is present and consistent with AGENTS.md description.

- **Routers (`backend/app/api/`)**
  - `health.py`: `GET /api/health` (via router prefix `/health`) returns `{"status": "ok", "timestamp": <UTC ISO>}`.
  - `meta.py`: `GET /api/meta` returns `countries`, `programs`, `exams` collections using SQLAlchemy `select` queries and Pydantic meta schemas.
  - `universities.py`:
    - `GET /api/universities` supports filters `country`, `program`, `exam`, `min_score`, `q`, as well as pagination (`page`, `limit`).
    - `GET /api/universities/{university_id}` returns detailed university info with nested programs and per-exam requirements.
  - **Assessment**: Router set matches the endpoint list from AGENTS.md and `backend/README.md`. No extra/undocumented endpoints detected.

- **Service Layer (`backend/app/services/`)**
  - `university_service.py` (not fully inspected in this report) is referenced from `universities.py` as the abstraction for query logic.
  - **Assessment**: Presence of a dedicated service aligns with documented architecture (thin routers, richer service layer).

- **Models & Schemas**
  - SQLAlchemy models located under `backend/app/models/` (Country, University, Program, Exam, Requirement) per AGENTS.md.
  - Pydantic schemas for meta and universities are under `backend/app/schemas/`.
  - **Assessment**: Structure is consistent with documentation; detailed model-level validation vs QA_GUIDE.md is not performed due to missing QA_GUIDE in the workspace (see Section 3).

### 3. QA Guide Availability

- **Observation**: File `QA_GUIDE.md` is referenced in AGENTS.md but is **not present** in the repository (no matches via `**/QA_GUIDE.md`).
- **Impact**: Cannot strictly compare current behavior and contracts against the referenced QA specification.
- **Severity**: Medium (process/documentation gap rather than runtime defect).
- **Classification**: **Not a product bug**, but a missing documentation artifact required by the QA process.
- **Recommendation**: Add `QA_GUIDE.md` to the repository or adjust AGENTS.md to point to the correct location. (Recommendation only; implementation is out of scope for this agent.)

### 4. Endpoint Contract vs Tests

Using `backend/tests/` as an executable specification of expected behavior:

- **`GET /api/health`**
  - Tests (`test_health.py`) expect:
    - HTTP 200.
    - JSON payload with `status == "ok"` and a `timestamp` field.
  - Implementation (`health.py`) returns exactly this payload via `health_check()` with UTC ISO timestamp.
  - **Result**: **Pass** (API contract and tests are aligned).

- **`GET /api/meta`**
  - Tests (`test_meta.py`) expect:
    - HTTP 200.
    - JSON with keys `countries`, `programs`, `exams`.
    - Each list has at least minimal contents (≥2 countries, ≥2 programs, ≥1 exam in the seeded data).
    - Country entries expose at least `id`, `name`, `code`.
  - Implementation (`meta.py`) uses ORM entities and Pydantic meta schemas to build this shape.
  - **Result**: **Pass** (shape and intent match tests and README description).

- **`GET /api/universities`**
  - Tests (`test_universities.py`) expect:
    - HTTP 200.
    - `total ≥ 2`, `len(items) ≥ 2`.
    - Each item contains `id`, `name`, `city`, `country`, `programs_count`.
  - Implementation (`universities.py`) builds `UniversityListResponse` items with exactly these fields, including nested `country`.
  - **Result**: **Pass** at contract level (per static analysis and tests).

- **`GET /api/universities/{id}`**
  - Tests expect:
    - Detail endpoint returns 200 for a valid ID taken from the listing.
    - Payload includes matching `id`, `country.code` in `{ "KZ", "TR" }`, and `programs` with `requirements` entries.
  - Implementation constructs `programs` list by grouping requirements and sorting programs by lowercased name.
  - **Result**: **Pass** at contract level (per static analysis and tests).

### 5. Issues & Findings

#### 5.1 Critical Issues

- **None identified** based on static analysis of backend code and existing tests.
- Runtime could not be validated due to server unavailability (see Section 1), but this is tracked as an environment issue rather than a confirmed defect.

#### 5.2 Medium Issues

1. **Missing `QA_GUIDE.md` in repository**
   - **Description**: `AGENTS.md` and the workflow description reference `QA_GUIDE.md` as a primary QA specification source. No such file exists in the project tree.
   - **Impact**: QA agent cannot strictly verify behavior against the intended formal guide; future contributors may lack a canonical testing checklist.
   - **Severity**: Medium.
   - **Classification**: **Process/documentation gap, not a runtime bug**.

2. **Backend server not reachable during MCP Playwright checks**
   - **Description**: All attempts to open `/api/health`, `/api/meta`, `/api/universities` via Playwright resulted in `ERR_CONNECTION_REFUSED`.
   - **Impact**: No live runtime confirmation of endpoints from this environment; only tests and static analysis are available.
   - **Severity**: Medium for this QA session.
   - **Classification**: **Environment/configuration issue, not a code defect**.

#### 5.3 Low Issues / Observations

1. **Implicit assumptions in tests about seed data**
   - **Description**: Tests expect specific minimum counts and country codes (`{"KZ", "TR"}`), implying that seed data must include those entities.
   - **Impact**: Changing demo data or supporting new environments may require test updates; however, this is acceptable for a controlled demo project.
   - **Severity**: Low.
   - **Classification**: Design choice, **not a bug**.

2. **QA Report Template not explicitly present**
   - **Description**: Notion search reveals a `QA Reports` page, but no dedicated `QA Report – Template` page or local template file is visible in the repo.
   - **Impact**: QA reports rely on convention rather than a strictly enforced template.
   - **Severity**: Low.
   - **Classification**: Documentation/organization issue, **not a bug**.

### 6. Missing Features (Recorded as “Not a Bug”)

The following are **expected** given current documentation and scope and are **explicitly not considered bugs**:

- No additional resources beyond `health`, `meta`, and `universities` (e.g., no dedicated CRUD endpoints for programs, exams, or countries).
- No authentication/authorization on endpoints.
- No rate limiting or advanced error telemetry.
- No multi-language content or localization for university descriptions.

These may be future enhancements but are out of scope of the current backend as documented in `AGENTS.md` and `backend/README.md`.

### 7. Notion QA Report Update (Planned)

- **Target page**: `Shared → QA Reports` (current page ID: `2cd3004a-c4a8-805c-bdcf-d9b175324de6`).
- **Status**: This local report content is ready to be mirrored into Notion following the “QA Report – Template” structure. The Notion page currently has no detailed content; populating it can be done by copying the sections above.


